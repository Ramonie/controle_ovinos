{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>{% if form.instance.pk %}Editar Ovino{% else %}Adicionar Ovino{% endif %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    input[type="file"] {
      padding: 6px;
    }
  </style>
</head>
<body>
<div class="container my-0">

  <h1 class="mb-4 text-center">
    {% if form.instance.pk %}
      Editar Ovino: {{ form.instance.numero_brinco }}
    {% else %}
      Adicionar Novo Ovino
    {% endif %}
  </h1>

  <div class="card shadow">
    <div class="row g-0">
      <!-- Coluna da imagem -->
      <div class="col-md-4 text-center p-3 d-flex align-items-center justify-content-center">
        <div style="position: relative;">
          <img 
            id="preview" 
            src="{% if form.instance.foto %}{{ form.instance.foto.url }}{% else %}https://via.placeholder.com/300x300?text=Sem+Foto{% endif %}" 
            class="img-fluid rounded" 
            alt="Pré-visualização" 
            style="max-width: 100%; height: auto; border: 1px solid #ccc; border-radius: 8px; cursor: pointer;"
            onclick="document.getElementById('id_foto').click()"
          >
        </div>
      </div>

      <!-- Coluna do formulário -->
      <div class="col-md-8">
        <div class="card-body">
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="row mb-3">
             <div class="col-md-6">
                <label for="numero_brinco" class="form-label">Número Brinco</label>
                {{ form.numero_brinco }}
                {% if form.numero_brinco.errors %}
                    <div class="text-danger small mt-1">
                    {{ form.numero_brinco.errors.0 }}
                    </div>
                {% endif %}
                </div>


                

              <div class="col-md-6">
                <label for="id_raca" class="form-label">Raça</label>
                {{ form.raca|add_class:"form-control" }}
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_sexo" class="form-label">Sexo</label>
                {{ form.sexo|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_cor" class="form-label">Cor</label>
                {{ form.cor|add_class:"form-control" }}
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_peso_atual" class="form-label">Peso atual</label>
                {{ form.peso_atual|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_altura" class="form-label">Altura</label>
                {{ form.altura|add_class:"form-control" }}
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_peso_ao_nascer" class="form-label">Peso ao nascer</label>
                {{ form.peso_ao_nascer|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_quantidade_crias" class="form-label">Quantidade de crias</label>
                {{ form.quantidade_crias|add_class:"form-control" }}
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_filiacao" class="form-label">Filiação</label>
                {{ form.filiacao|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_data_nascimento" class="form-label">Data nascimento</label>
                {{ form.data_nascimento|add_class:"form-control" }}
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_status" class="form-label">Status</label>
                {{ form.status|add_class:"form-control" }}
              </div>
              <div class="col-md-6">
                <label for="id_foto" class="form-label">Foto</label>
                {{ form.foto|add_class:"form-control" }}
              </div>
            </div>

            <div class="d-flex justify-content-between mt-4">
              <a href="{% url 'lista_ovinos' %}" class="btn btn-secondary">Voltar à Lista</a>
              <button type="submit" class="btn btn-success">Salvar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Atualiza a imagem de pré-visualização ao escolher um novo arquivo
  document.getElementById("id_foto").addEventListener("change", function(event) {
    const [file] = event.target.files;
    if (file) {
      const preview = document.getElementById("preview");
      preview.src = URL.createObjectURL(file);
      preview.style.display = "block";
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


</body>
</html>
